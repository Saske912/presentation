---
theme: ../themes/custom
layout: cover
background: '#1e3a8a'
class: text-center
highlighter: shiki
lineNumbers: false
info: |
  ## Infrastructure as Code –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω
  –ü–µ—Ä–µ—Ö–æ–¥ –æ—Ç —Ä—É—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
drawings:
  persist: false
transition: slide-left
title: IaC –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º–∏ –º–∞—à–∏–Ω–∞–º–∏
mdc: true
---

# Infrastructure as Code
## –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º–∏ –º–∞—à–∏–Ω–∞–º–∏

**Proxmox + Packer + Terraform**

–û—Ç —Ö–∞–æ—Å–∞ –∫ –ø–æ—Ä—è–¥–∫—É

---
layout: section
---

# –¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è

---

# –ü—Ä–æ–±–ª–µ–º—ã —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ üî•

<v-clicks>

## –ó–∞–∫–∞–∑ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω –∑–∞–Ω–∏–º–∞–µ—Ç –Ω–µ–¥–µ–ª–∏

- üìß –ó–∞—è–≤–∫–∞ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ VM ‚Üí –æ–∂–∏–¥–∞–Ω–∏–µ 2-3 –Ω–µ–¥–µ–ª–∏
- ‚ùì –ü–æ–ª—É—á–∞–µ–º –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ —á—Ç–æ —Å –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
- üîß –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –∑–∞–∫–∞–∑–∞–Ω–Ω—ã–º

## –°–µ—Ç–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –ø–æ—Å—Ç–æ—è–Ω–Ω–æ

- ‚úÖ HTTP —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø–æ–≤–µ–∑–ª–æ!)
- ‚ùå –ü–∞–∫–µ—Ç—ã –º–µ–∂–¥—É –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏ –Ω–µ —Ö–æ–¥—è—Ç
- üó£Ô∏è –î–æ–ª–≥–∏–µ —Å–ø–æ—Ä—ã –∏ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞, —á—Ç–æ "—á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"

## –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏

- üé≤ –ö–∞–∂–¥–∞—è VM - —ç—Ç–æ —Å—é—Ä–ø—Ä–∏–∑
- üìù –ù–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
- üîÑ –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

</v-clicks>

---
layout: section
---

# –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ

---

# Infrastructure as Code –ø–æ–¥—Ö–æ–¥ üöÄ

<v-clicks>

## –ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç?

**–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ –≤–∏–¥–µ –∫–æ–¥–∞**

```hcl
resource "proxmox_vm_qemu" "k8s_worker" {
  name        = "k8s-worker-01"
  target_node = "pve-node-01"
  memory      = 16384
  cores       = 8
  
  network {
    model   = "virtio"
    bridge  = "vmbr0"
    tag     = 100  # VLAN –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∞
  }
  
  disk {
    storage = "local-lvm"
    size    = "100G"
  }
}
```

**–û–¥–∏–Ω –∫–ª–∏–∫ ‚Üí –≥–æ—Ç–æ–≤–∞—è VM —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π**

</v-clicks>

---

# –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫ üõ†Ô∏è

<v-clicks>

## 1. **Proxmox** - –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏

- –£ –Ω–∞—Å —É–∂–µ –µ—Å—Ç—å!
- –ú–æ—â–Ω—ã–π API –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Terraform

## 2. **Packer** - —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤ VM

- –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–∑—ã –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
- –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –ü–û –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤

## 3. **Terraform/OpenTofu** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π

- –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- –£ –Ω–∞—Å —É–∂–µ –µ—Å—Ç—å –æ–ø—ã—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (K8s –∫–ª–∞—Å—Ç–µ—Ä)
- –ö–æ–Ω—Ç—Ä–æ–ª—å –≤–µ—Ä—Å–∏–π —á–µ—Ä–µ–∑ Git

</v-clicks>

---

# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è üìê

```mermaid
graph TB
    subgraph "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞"
        CODE[Infrastructure Code<br/>Git Repository]
        PACKER[Packer Templates<br/>VM Images]
    end
    
    subgraph "CI/CD"
        FORGEJO[Forgejo Git]
        RUNNER[CI Runner]
        VALIDATE[Validate & Test]
    end
    
    subgraph "Proxmox Infrastructure"
        PROXMOX[Proxmox VE Cluster]
        IMAGES[Image Storage<br/>VM Templates]
        
        subgraph "Kubernetes Cluster"
            K8S_CP[Control Plane Nodes]
            K8S_WN[Worker Nodes]
        end
        
        subgraph "Docker Swarm Clusters"
            SWARM1[Swarm Cluster 1]
            SWARM2[Swarm Cluster 2]
        end
        
        subgraph "Services"
            DB[Databases]
            APP[Applications]
        end
    end
    
    CODE --> FORGEJO
    PACKER --> FORGEJO
    FORGEJO --> RUNNER
    RUNNER --> VALIDATE
    VALIDATE --> PROXMOX
    PACKER -.->|Build Images| IMAGES
    IMAGES --> K8S_CP
    IMAGES --> K8S_WN
    IMAGES --> SWARM1
    IMAGES --> SWARM2
    IMAGES --> DB
    IMAGES --> APP
    
    style CODE fill:#4ade80
    style PACKER fill:#4ade80
    style PROXMOX fill:#3b82f6
    style IMAGES fill:#f59e0b
```

---

# –ü—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è VM: –ë—ã–ª–æ vs –°—Ç–∞–Ω–µ—Ç

<div class="grid grid-cols-2 gap-4">

<div>

## ‚ùå –ë–´–õ–û (2-3 –Ω–µ–¥–µ–ª–∏)

```mermaid
graph TD
    A[–ó–∞—è–≤–∫–∞ –Ω–∞ VM] -->|3-5 –¥–Ω–µ–π| B[–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ]
    B -->|5-7 –¥–Ω–µ–π| C[–°–æ–∑–¥–∞–Ω–∏–µ VM]
    C -->|2-3 –¥–Ω—è| D[–ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞]
    D -->|1-2 –¥–Ω—è| E[–ü–µ—Ä–µ–¥–∞—á–∞]
    E --> F{–ü—Ä–æ–≤–µ—Ä–∫–∞}
    F -->|–ü—Ä–æ–±–ª–µ–º—ã| G[–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ]
    G -->|3-5 –¥–Ω–µ–π| F
    F -->|OK| H[–ì–æ—Ç–æ–≤–æ]
    
    style A fill:#ef4444
    style G fill:#ef4444
    style H fill:#22c55e
```

**–ò—Ç–æ–≥–æ: 15-20 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π**

</div>

<div>

## ‚úÖ –°–¢–ê–ù–ï–¢ (5-10 –º–∏–Ω—É—Ç)

```mermaid
graph TD
    A[–û–ø–∏—Å–∞–Ω–∏–µ –≤ –∫–æ–¥–µ] -->|1 –º–∏–Ω| B[Git Push]
    B -->|2 –º–∏–Ω| C[CI –ø—Ä–æ–≤–µ—Ä–∫–∞]
    C -->|5 –º–∏–Ω| D[Terraform Apply]
    D --> E[–ì–æ—Ç–æ–≤–æ]
    
    style A fill:#22c55e
    style B fill:#22c55e
    style C fill:#22c55e
    style D fill:#22c55e
    style E fill:#22c55e
```

**–ò—Ç–æ–≥–æ: 5-10 –º–∏–Ω—É—Ç**

</div>

</div>

---

# –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ IaC –ø–æ–¥—Ö–æ–¥–∞ üíé

<v-clicks depth="2">

## üöÄ –°–∫–æ—Ä–æ—Å—Ç—å

- **–û—Ç –Ω–µ–¥–µ–ª—å –∫ –º–∏–Ω—É—Ç–∞–º**: —Å–æ–∑–¥–∞–Ω–∏–µ VM –∑–∞ 5-10 –º–∏–Ω—É—Ç
- **–ú–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ**: –Ω—É–∂–Ω–æ 10 –Ω–æ–≤—ã—Ö worker nodes? –û–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä!
- **–ë—ã—Å—Ç—Ä–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ**: —É–ø–∞–ª–∞ VM? –ü–µ—Ä–µ—Å–æ–∑–¥–∞—ë–º –∑–∞ –º–∏–Ω—É—Ç—ã

## üéØ –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å

- **–ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –≤—Å–µ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ–º —Ç–æ, —á—Ç–æ –æ–ø–∏—Å–∞–ª–∏
- **–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è**: –≤—Å–µ VM —Å–æ–∑–¥–∞—é—Ç—Å—è –ø–æ –µ–¥–∏–Ω–æ–º—É —à–∞–±–ª–æ–Ω—É
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: CI –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **–ö–æ–¥ = –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –≤—Å—ë –æ–ø–∏—Å–∞–Ω–æ —è–≤–Ω–æ
- **–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π**: Git —Ö—Ä–∞–Ω–∏—Ç –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é
- **Code Review**: –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ—Ö–æ–¥—è—Ç —Ä–µ–≤—å—é

</v-clicks>

---

# –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ IaC –ø–æ–¥—Ö–æ–¥–∞ (–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ) üíé

<v-clicks depth="2">

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ–±—Ä–∞–∑—ã**: –µ–¥–∏–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **–ö–æ–Ω—Ç—Ä–æ–ª—å –∏–∑–º–µ–Ω–µ–Ω–∏–π**: –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–∏–¥–Ω—ã –≤ Git
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: –æ–±—Ä–∞–∑—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ

## üí∞ –≠–∫–æ–Ω–æ–º–∏—è

- **–≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏ DevOps**: –º–µ–Ω—å—à–µ —Ä—É—á–Ω–æ–π —Ä–∞–±–æ—Ç—ã
- **–≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤**: –º–µ–Ω—å—à–µ —Ä—É—Ç–∏–Ω—ã
- **–ú–µ–Ω—å—à–µ –ø—Ä–æ—Å—Ç–æ–µ–≤**: –±—ã—Å—Ç—Ä–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

## üîÑ –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å

- **Dev = Stage = Prod**: –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **Disaster Recovery**: –±—ã—Å—Ç—Ä–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–±–æ—è
- **–¢–µ—Å—Ç–æ–≤—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**: —Å–æ–∑–¥–∞—ë–º –∑–∞ –º–∏–Ω—É—Ç—ã

</v-clicks>

---

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è üìã

<v-clicks>

## –°—Ü–µ–Ω–∞—Ä–∏–π 1: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ K8s –∫–ª–∞—Å—Ç–µ—Ä–∞

```bash
# –ë—ã–ª–æ: –∑–∞—è–≤–∫–∞ + 2-3 –Ω–µ–¥–µ–ª–∏ –æ–∂–∏–¥–∞–Ω–∏—è
# –°—Ç–∞–ª–æ:
terraform apply -var="worker_nodes=5"  # +5 –Ω–æ–≤—ã—Ö worker nodes –∑–∞ 10 –º–∏–Ω—É—Ç
```

## –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ù–æ–≤—ã–π Swarm –∫–ª–∞—Å—Ç–µ—Ä

```bash
# –ë—ã–ª–æ: –º–µ—Å—è—Ü –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫—É –∫–ª–∞—Å—Ç–µ—Ä–∞ –∏–∑ 6 VM
# –°—Ç–∞–ª–æ:
terraform apply -var="swarm_cluster=true"  # –í–µ—Å—å –∫–ª–∞—Å—Ç–µ—Ä –∑–∞ 15 –º–∏–Ω—É—Ç
```

## –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é

```hcl
# –ë—ã–ª–æ: –¥–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–¥–º–∏–Ω–∞–º —á—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–¥–µ–ª—é
# –°—Ç–∞–ª–æ: –≤—Å—ë —è–≤–Ω–æ –æ–ø–∏—Å–∞–Ω–æ –≤ –∫–æ–¥–µ
network {
  model   = "virtio"
  bridge  = "vmbr0"
  tag     = 100  # VLAN –¥–ª—è inter-cluster —Å–≤—è–∑–∏
  firewall = true
}
```

</v-clicks>

---

# Packer: –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–∑—ã üì¶

<v-clicks>

## –ß—Ç–æ –¥–∞—ë—Ç Packer?

**–°–æ–∑–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤—ã—Ö –æ–±—Ä–∞–∑–æ–≤ VM —Å –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –ü–û**

```hcl
# Ubuntu –æ–±—Ä–∞–∑ –¥–ª—è K8s Worker
source "proxmox-iso" "ubuntu-k8s" {
  iso_file         = "local:iso/ubuntu-22.04-server.iso"
  vm_name          = "ubuntu-k8s-worker-template"
  memory           = 4096
  cores            = 2
  
  # –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–∫–∞
  provisioner "shell" {
    scripts = [
      "scripts/install-docker.sh",
      "scripts/install-kubernetes.sh",
      "scripts/configure-network.sh",
      "scripts/hardening.sh"
    ]
  }
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: VM –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è —Å —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º –ü–û

</v-clicks>

---

# –ü—Ä–∏–º–µ—Ä—ã –æ–±—Ä–∞–∑–æ–≤ –¥–ª—è –Ω–∞—à–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ üñºÔ∏è

<v-clicks>

## Kubernetes Worker

- Ubuntu 22.04 LTS
- Docker / containerd
- kubelet, kubeadm, kubectl
- –°–µ—Ç–µ–≤—ã–µ –ø–ª–∞–≥–∏–Ω—ã (Calico/Cilium)
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞–≥–µ–Ω—Ç—ã

## Docker Swarm Node

- Ubuntu 22.04 LTS
- Docker Engine
- Swarm dependencies
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞–≥–µ–Ω—Ç—ã
- Backup –∞–≥–µ–Ω—Ç—ã

## Database Server

- Ubuntu 22.04 LTS
- PostgreSQL / MySQL
- Backup tools
- Monitoring
- Security hardening

</v-clicks>

---

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π üîó

<v-clicks>

## –£ –Ω–∞—Å —É–∂–µ –µ—Å—Ç—å:

‚úÖ **Terraform –æ–ø—ã—Ç** - –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–ª—è K8s –∫–ª–∞—Å—Ç–µ—Ä–∞  
‚úÖ **Proxmox** - –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏  
‚úÖ **Forgejo** - Git —Å–µ—Ä–≤–µ—Ä  
‚úÖ **ArgoCD** - GitOps –¥–ª—è K8s  
‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - VictoriaMetrics + Loki  

## –ü—Ä–æ—Å—Ç–æ —Ä–∞—Å—à–∏—Ä—è–µ–º:

```
cluster_initial/
‚îú‚îÄ‚îÄ iac/
‚îÇ   ‚îú‚îÄ‚îÄ kubernetes/          # ‚Üê –£–∂–µ –µ—Å—Ç—å
‚îÇ   ‚îú‚îÄ‚îÄ proxmox-vms/         # ‚Üê –î–æ–±–∞–≤–∏–º
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ k8s-nodes/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ swarm-clusters/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ databases/
‚îÇ   ‚îî‚îÄ‚îÄ packer/              # ‚Üê –î–æ–±–∞–≤–∏–º
‚îÇ       ‚îú‚îÄ‚îÄ ubuntu-k8s/
‚îÇ       ‚îú‚îÄ‚îÄ ubuntu-swarm/
‚îÇ       ‚îî‚îÄ‚îÄ ubuntu-db/
```

</v-clicks>

---

# –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è üìÖ

<v-clicks depth="2">

## –§–∞–∑–∞ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (1-2 –Ω–µ–¥–µ–ª–∏)

- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Terraform provider –¥–ª—è Proxmox
- –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–≤—ã—Ö Packer –æ–±—Ä–∞–∑–æ–≤ (Ubuntu base)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CI/CD –¥–ª—è IaC

## –§–∞–∑–∞ 2: –ü–∏–ª–æ—Ç (2-3 –Ω–µ–¥–µ–ª–∏)

- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ Swarm –∫–ª–∞—Å—Ç–µ—Ä–∞ —á–µ—Ä–µ–∑ IaC
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–µ–≤–æ–π —Å–≤—è–∑–Ω–æ—Å—Ç–∏
- –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

## –§–∞–∑–∞ 3: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ (1-2 –º–µ—Å—è—Ü–∞)

- –ú–∏–≥—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö VM –Ω–∞ IaC
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- –û–±—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã

## –§–∞–∑–∞ 4: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–ø–æ—Å—Ç–æ—è–Ω–Ω–æ)

- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –æ–±—Ä–∞–∑–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- –£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

</v-clicks>

---

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤ üìä

<div class="grid grid-cols-2 gap-4">

<div>

## ‚ùå –¢–µ–∫—É—â–∏–π –ø–æ–¥—Ö–æ–¥

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –û—Ü–µ–Ω–∫–∞ |
|----------|--------|
| **–°–∫–æ—Ä–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è VM** | 2-3 –Ω–µ–¥–µ–ª–∏ |
| **–ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å** | ‚ùå –ù–∏–∑–∫–∞—è |
| **–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è** | ‚ùå –ù–µ—Ç |
| **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** | ‚ùå –£—Å—Ç–∞—Ä–µ–≤–∞–µ—Ç |
| **–°–µ—Ç–µ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞** | ‚ùå –ü—Ä–æ–±–ª–µ–º—ã |
| **–í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å** | ‚ùå –ù–∏–∑–∫–∞—è |
| **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** | ‚ùå –°–ª–æ–∂–Ω–æ |
| **–°—Ç–æ–∏–º–æ—Å—Ç—å –æ—à–∏–±–∫–∏** | üî¥ –í—ã—Å–æ–∫–∞—è |

</div>

<div>

## ‚úÖ IaC –ø–æ–¥—Ö–æ–¥

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –û—Ü–µ–Ω–∫–∞ |
|----------|--------|
| **–°–∫–æ—Ä–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è VM** | 5-10 –º–∏–Ω—É—Ç |
| **–ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å** | ‚úÖ –í—ã—Å–æ–∫–∞—è |
| **–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è** | ‚úÖ –ü–æ–ª–Ω–∞—è |
| **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** | ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–∞—è |
| **–°–µ—Ç–µ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞** | ‚úÖ –í –∫–æ–¥–µ |
| **–í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å** | ‚úÖ 100% |
| **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** | ‚úÖ –õ–µ–≥–∫–æ |
| **–°—Ç–æ–∏–º–æ—Å—Ç—å –æ—à–∏–±–∫–∏** | üü¢ –ù–∏–∑–∫–∞—è |

</div>

</div>

---

# –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞: K8s Worker Node üíª

```hcl
# –û–ø–∏—Å–∞–Ω–∏–µ worker node –¥–ª—è Kubernetes
resource "proxmox_vm_qemu" "k8s_worker" {
  count = var.worker_count  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ worker nodes

  name        = "k8s-worker-${count.index + 1}"
  target_node = var.proxmox_node
  clone       = "ubuntu-k8s-template"  # –û–±—Ä–∞–∑ –∏–∑ Packer
  
  # –†–µ—Å—É—Ä—Å—ã
  memory  = 16384  # 16GB RAM
  cores   = 8
  sockets = 1
  
  # –°–µ—Ç—å - –í–°–Å –Ø–í–ù–û –û–ü–ò–°–ê–ù–û!
  network {
    model   = "virtio"
    bridge  = "vmbr0"
    tag     = 100        # VLAN –¥–ª—è K8s –∫–ª–∞—Å—Ç–µ—Ä–∞
    firewall = true
  }
  
  # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å–µ—Ç—å –¥–ª—è inter-cluster —Å–≤—è–∑–∏
  network {
    model   = "virtio"
    bridge  = "vmbr1"
    tag     = 200        # VLAN –¥–ª—è Swarm —Å–≤—è–∑–∏
  }
  
  # –î–∏—Å–∫–∏
  disk {
    storage = "local-lvm"
    size    = "100G"
    type    = "scsi"
    ssd     = 1
  }
  
  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏
  provisioner "remote-exec" {
    inline = [
      "kubeadm join ${var.k8s_control_plane_endpoint}",
    ]
  }
  
  # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
  tags = ["kubernetes", "worker", "production"]
}
```

**–û–¥–∏–Ω —Ä–∞–∑ –æ–ø–∏—Å–∞–ª–∏ - —Ä–∞–±–æ—Ç–∞–µ—Ç –≤—Å–µ–≥–¥–∞ –æ–¥–∏–Ω–∞–∫–æ–≤–æ!**

---

# –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞: Swarm –∫–ª–∞—Å—Ç–µ—Ä üíª

```hcl
# –ü–æ–ª–Ω—ã–π Swarm –∫–ª–∞—Å—Ç–µ—Ä –∏–∑ 6 –Ω–æ–¥
module "swarm_cluster_production" {
  source = "./modules/swarm-cluster"
  
  cluster_name = "swarm-prod"
  
  # Manager nodes
  manager_count  = 3
  manager_memory = 8192
  manager_cores  = 4
  
  # Worker nodes
  worker_count  = 3
  worker_memory = 16384
  worker_cores  = 8
  
  # –°–µ—Ç—å
  cluster_vlan      = 100  # –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å–µ—Ç—å –∫–ª–∞—Å—Ç–µ—Ä–∞
  inter_cluster_vlan = 200  # –°–≤—è–∑—å —Å K8s
  
  # –û–±—Ä–∞–∑
  template_name = "ubuntu-swarm-template"
  
  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Swarm
  auto_init = true
}
```

**–ö–æ–º–∞–Ω–¥–∞ `terraform apply` ‚Üí –≥–æ—Ç–æ–≤—ã–π –∫–ª–∞—Å—Ç–µ—Ä –∑–∞ 15 –º–∏–Ω—É—Ç!**

---

# ROI: –í–æ–∑–≤—Ä–∞—Ç –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π üí∞

<v-clicks>

## –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏

- üë®‚Äçüíª 2 –Ω–µ–¥–µ–ª–∏ –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫—É –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- üìö 1 –Ω–µ–¥–µ–ª—è –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ –æ–±—É—á–µ–Ω–∏–µ
- **–ò—Ç–æ–≥–æ: ~120 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã**

## –≠–∫–æ–Ω–æ–º–∏—è (–µ–∂–µ–º–µ—Å—è—á–Ω–æ)

| –°—Ü–µ–Ω–∞—Ä–∏–π | –ë—ã–ª–æ | –°—Ç–∞–Ω–µ—Ç | –≠–∫–æ–Ω–æ–º–∏—è |
|----------|------|--------|----------|
| –°–æ–∑–¥–∞–Ω–∏–µ 5 VM –¥–ª—è –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ | 80 —á | 2 —á | **78 —á/–º–µ—Å** |
| –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ K8s (3 worker) | 60 —á | 1 —á | **59 —á/–º–µ—Å** |
| –ù–æ–≤—ã–π Swarm –∫–ª–∞—Å—Ç–µ—Ä | 120 —á | 2 —á | **118 —á/–º–µ—Å** |
| –¢–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ | 40 —á | 1 —á | **39 —á/–º–µ—Å** |
| –û—Ç–ª–∞–¥–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –ø—Ä–æ–±–ª–µ–º | 30 —á | 5 —á | **25 —á/–º–µ—Å** |

**–ò—Ç–æ–≥–æ —ç–∫–æ–Ω–æ–º–∏—è: ~320 —á–∞—Å–æ–≤ –≤ –º–µ—Å—è—Ü**

## –û–∫—É–ø–∞–µ–º–æ—Å—Ç—å: **2 –Ω–µ–¥–µ–ª–∏!** üöÄ

</v-clicks>

---

# –†–∏—Å–∫–∏ –∏ –∏—Ö –º–∏—Ç–∏–≥–∞—Ü–∏—è ‚ö†Ô∏è

<div class="grid grid-cols-2 gap-4">

<div>

## ‚ö†Ô∏è –†–∏—Å–∫–∏

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ**
- –ü—Ä–æ–±–ª–µ–º—ã —Å Proxmox API
- –û—à–∏–±–∫–∏ –≤ Terraform –∫–æ–¥–µ

**–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ**
- –°–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –∑–Ω–∞–Ω–∏–π –≤ –∫–æ–º–∞–Ω–¥–µ

**–ü—Ä–æ—Ü–µ—Å—Å–Ω—ã–µ**
- –û—à–∏–±–∫–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤

</div>

<div>

## ‚úÖ –ú–∏—Ç–∏–≥–∞—Ü–∏—è

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ**
- Pilot –ø—Ä–æ–µ–∫—Ç –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏
- Code review –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ**
- –û–±—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤

**–ü—Ä–æ—Ü–µ—Å—Å–Ω—ã–µ**
- –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ
- –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –æ—Ç –∫–æ–º–∞–Ω–¥—ã
- –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ

</div>

</div>

---

# –ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –≤ –∏–Ω–¥—É—Å—Ç—Ä–∏–∏ üåç

<v-clicks>

## –≠—Ç–æ –Ω–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç - —ç—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç!

**Netflix** - –ø–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ IaC  
- –¢—ã—Å—è—á–∏ VM —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–æ–¥–æ–º
- Deployment –∑–∞ –º–∏–Ω—É—Ç—ã –≤–º–µ—Å—Ç–æ –Ω–µ–¥–µ–ª—å

**Spotify** - Infrastructure as Code —Å –Ω–∞—á–∞–ª–∞  
- –í—Å–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–¥–µ–Ω—Ç–∏—á–Ω—ã
- Zero downtime deployments

**HashiCorp** (—Å–æ–∑–¥–∞—Ç–µ–ª–∏ Terraform)  
- –ü—Ä–∞–∫—Ç–∏–∫—É—é—Ç IaC –Ω–∞ —Å–µ–±–µ
- –ü—É–±–ª–∏–∫—É—é—Ç best practices

**Google/AWS/Azure**  
- –í—Å–µ –æ–±–ª–∞—á–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã –Ω–∞ IaC
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –º–∞—Å—à—Ç–∞–±–æ–º –≤—Ä—É—á–Ω—É—é

</v-clicks>

---

# –ß—Ç–æ –º—ã –ø–æ–ª—É—á–∏–º –≤ –∏—Ç–æ–≥–µ? üéÅ

<v-clicks depth="2">

## –°–∫–æ—Ä–æ—Å—Ç—å –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

- ‚ö° VM –∑–∞ –º–∏–Ω—É—Ç—ã –≤–º–µ—Å—Ç–æ –Ω–µ–¥–µ–ª—å
- üîÑ –ë—ã—Å—Ç—Ä–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- üöÄ –ú–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ —Ç–∏—Ä–∞–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏–π

## –ö–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å

- ‚úÖ –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–∞–∂–¥—ã–π —Ä–∞–∑
- üìã –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- üîí –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

## –£–ø—Ä–∞–≤–ª—è–µ–º–æ—Å—Ç—å

- üìö –ê–∫—Ç—É–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ –∫–æ–¥–µ
- üîç –ü–æ–ª–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚Ü©Ô∏è –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –∑–∞ —Å–µ–∫—É–Ω–¥—ã

## –ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å

- üéØ –ù–µ –∂–¥—ë–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- üí™ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
- üîß –°–∞–º–æ–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

</v-clicks>

---
layout: section
---

# –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è

---

# –î–µ–º–æ: –°–æ–∑–¥–∞–Ω–∏–µ Swarm –∫–ª–∞—Å—Ç–µ—Ä–∞ üé¨

<v-clicks>

## –®–∞–≥ 1: –û–ø–∏—Å—ã–≤–∞–µ–º –∫–ª–∞—Å—Ç–µ—Ä –≤ –∫–æ–¥–µ

```bash
vim terraform/swarm-cluster.tf
```

## –®–∞–≥ 2: –ü–ª–∞–Ω–∏—Ä—É–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è

```bash
terraform plan
# Output: Will create 6 VMs with proper network configuration
```

## –®–∞–≥ 3: –ü—Ä–∏–º–µ–Ω—è–µ–º

```bash
terraform apply
# 10 –º–∏–Ω—É—Ç ‚Üí –≥–æ—Ç–æ–≤—ã–π –∫–ª–∞—Å—Ç–µ—Ä
```

## –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—è–µ–º

```bash
ssh swarm-manager-01
docker node ls
# 3 managers + 3 workers, all Ready
```

**–í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞!**

</v-clicks>

---

# –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ üìã

<v-clicks depth="2">

## –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ (—ç—Ç–∞ –Ω–µ–¥–µ–ª—è)

1. ‚úÖ –û–¥–æ–±—Ä–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏
2. üîß –í—ã–¥–µ–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è pilot –ø—Ä–æ–µ–∫—Ç–∞
3. üë• –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö

## –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ (2-4 –Ω–µ–¥–µ–ª–∏)

1. üõ†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (Terraform + Packer)
2. üß™ Pilot: —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ Swarm –∫–ª–∞—Å—Ç–µ—Ä–∞
3. üìä –û—Ü–µ–Ω–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ pilot

## –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–æ (2-3 –º–µ—Å—è—Ü–∞)

1. üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –≤—Å–µ –Ω–æ–≤—ã–µ VM
2. üìö –û–±—É—á–µ–Ω–∏–µ –≤—Å–µ–π –∫–æ–º–∞–Ω–¥—ã
3. üìñ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ

1. üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö VM (–ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ)
2. üöÄ –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
3. üí° –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ

</v-clicks>

---
layout: center
class: text-center
---

# –í–æ–ø—Ä–æ—Å—ã? ü§î

---
layout: section
---

# –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

# –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ê: –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ üîß

## Terraform Provider –¥–ª—è Proxmox

```hcl
terraform {
  required_providers {
    proxmox = {
      source  = "telmate/proxmox"
      version = "~> 2.9"
    }
  }
}

provider "proxmox" {
  pm_api_url      = var.proxmox_api_url
  pm_api_token_id = var.proxmox_token_id
  pm_api_token_secret = var.proxmox_token_secret
  pm_tls_insecure = true
}
```

## Packer Builder

```hcl
packer {
  required_plugins {
    proxmox = {
      version = ">= 1.1.0"
      source  = "github.com/hashicorp/proxmox"
    }
  }
}
```

---

# –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ë: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è üìÅ

```
cluster_initial/
‚îú‚îÄ‚îÄ iac/
‚îÇ   ‚îú‚îÄ‚îÄ proxmox-vms/                    # –ù–æ–≤–æ–µ: VM –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ modules/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ k8s-node/               # –ú–æ–¥—É–ª—å –¥–ª—è K8s node
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ swarm-cluster/          # –ú–æ–¥—É–ª—å –¥–ª—è Swarm –∫–ª–∞—Å—Ç–µ—Ä–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ database-vm/            # –ú–æ–¥—É–ª—å –¥–ª—è DB —Å–µ—Ä–≤–µ—Ä–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ envs/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dev/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ staging/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ prod/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ README.md
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ packer/                         # –ù–æ–≤–æ–µ: –û–±—Ä–∞–∑—ã VM
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ubuntu-k8s-worker/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ubuntu.pkr.hcl
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ scripts/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ubuntu-swarm/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ubuntu-db/
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ kubernetes/                     # –°—É—â–µ—Å—Ç–≤—É—é—â–µ–µ
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îî‚îÄ‚îÄ docs/
    ‚îî‚îÄ‚îÄ IAC_RUNBOOK.md                  # –ù–æ–≤–æ–µ: –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
```

---

# –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –í: –ü—Ä–∏–º–µ—Ä CI/CD –ø–∞–π–ø–ª–∞–π–Ω–∞ üîÑ

```yaml
# .forgejo/workflows/infrastructure.yaml
name: Infrastructure CI/CD

on:
  push:
    paths:
      - 'iac/proxmox-vms/**'

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      
      - name: Terraform Init
        run: terraform init
        working-directory: iac/proxmox-vms/envs/prod
      
      - name: Terraform Validate
        run: terraform validate
      
      - name: Terraform Plan
        run: terraform plan
        env:
          PROXMOX_TOKEN_ID: ${{ secrets.PROXMOX_TOKEN_ID }}
          PROXMOX_TOKEN_SECRET: ${{ secrets.PROXMOX_TOKEN_SECRET }}
  
  apply:
    needs: validate
    if: github.ref == 'refs/heads/main'
    runs-on: ubuntu-latest
    steps:
      - name: Terraform Apply
        run: terraform apply -auto-approve
```

---

# –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ì: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ IaC üìä

<v-clicks>

## –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

- ‚è±Ô∏è –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è VM (target: < 10 –º–∏–Ω—É—Ç)
- ‚úÖ Success rate (target: > 95%)
- üîÑ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ VM, —É–ø—Ä–∞–≤–ª—è–µ–º—ã—Ö —á–µ—Ä–µ–∑ IaC
- üìâ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä—É—á–Ω—ã—Ö –∑–∞—è–≤–æ–∫ –Ω–∞ VM
- ‚ö° –í—Ä–µ–º—è –æ—Ç commit –¥–æ deployed VM

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º

```yaml
# VictoriaMetrics
- record: infrastructure:vm_creation_time
  expr: |
    histogram_quantile(0.95,
      rate(terraform_apply_duration_seconds_bucket[5m])
    )

- alert: VMCreationSlow
  expr: infrastructure:vm_creation_time > 600  # > 10 –º–∏–Ω—É—Ç
  annotations:
    summary: "VM creation is taking too long"
```

</v-clicks>

---
layout: center
class: text-center
---

# –°–ø–∞—Å–∏–±–æ –∑–∞ –≤–Ω–∏–º–∞–Ω–∏–µ! üôè

## –î–∞–≤–∞–π—Ç–µ —Å–¥–µ–ª–∞–µ–º –Ω–∞—à—É –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π!

**–ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤:**  
SRE Team  
m.prigorodov@tetra-soft.ru

---
layout: end
---

# –í–º–µ—Å—Ç–µ –∫ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏! üöÄ

